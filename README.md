# DuckInterface

This repository contains my attempt for enabling duck typing support in C#. It is powered by Roslyn and new C# 9 feature Source Generators. 
I would say it is purly accademic/just for fun stuff, but for some scenarios it can be usefull.

[![Nuget](https://img.shields.io/badge/nuget-DuckInterface-blue?style=flat-square&logo=nuget)](https://www.nuget.org/packages/DuckInterface/)

# How to use it

Lets suppose that you have a next declaration:
``` cs 
public interface ICalculator
{
  float Calculate(float a, float b);
}

public class AddCalculator
{
  float Calculate(float a, float b);
}
```
It is impotant to notice that the ``` AddCalculator ``` doesn't implement a ``` ICalculator ``` in any way. It just have an indentical method declaration.
Of cause, if we try to use it like in next snippet we will get a compilation error:

``` cs
var addCalculator = new AddCalculator();

var result = Do(addCalculator, 10, 20);

float Do(ICalculator calculator, float a, float b)
{
  return calculator.Calculate(a, b);
}

```
In this case duck typing can be heplfull, because it will allow us to pass ``` AddCalculator ``` with ease. The ``` DuckInterface ``` may help with it. 
You will need to install nuget package and update interface declartion like that:

``` cs 
[Duckable]
public interface ICalculator
{
  float Calculate(float a, float b);
}
```

Then we will need to update the ``` Do ``` method. Repace the ``` ICalculator ``` with a ``` DICalculator ```. 
The ``` DICalculator ``` it is a class that was generated by ``` DuckInterface ```. The generation powered by new Source Generatators from C# 9. 
The ``` DICalculator ``` has a public interface indentical to ``` ICalculator ``` and can contain implicit conversion operators for any class(there is some edge cases 
we will talk about them later). Those implicit conversion operators are generated by the Source Generator too. The generation happens on a fly as you writing source code in IDE and depends on the ``` DICalculator ``` usage. 

The final snippet:
``` cs
var addCalculator = new AddCalculator();

var result = Do(addCalculator, 10, 20);

float Do(DICalculator calculator, float a, float b)
{
  return calculator.Calculate(a, b);
}

```
And it's done. The compilation errors are gone and everthing works as expected.
